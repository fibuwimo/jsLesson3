<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>くっきいくりっかあ</title>
</head>
<body>
    <div style="display:flex;">
    <div style="width:400px;">
    <button type="button" id="cre" style="width:200px;height:100px;"><span id="creNum"></span>枚作る</button>
    <div style="margin-bottom:20px;">
    <img  id="cImage" src="images/sweets_cookie.png" width="100px" height="100px" alt="クッキー" />
    <font size="6"><span id="result">×0</span></font>
    <br>
    <font size="4"><span id="infoClick">(1枚/クリック)　</span></font>
    <font size="4"><span id="infoAuto">(0枚/秒)</span></font>
    </div>
    <div>
    <button id="buy">クッキー焼き機を購入(50枚)</button>
    <a>(クリック生成効率↑)</a>
    <div id="renji"></div>
    </div>
    <div>
    <button id="buy2">博士を購入(50枚)</button>
    <a>(クッキー自動生成)</a>
    <div id="hakase"></div>
    </div>
    <div>
        <button id="buy3">女王様を購入(10000枚)</button>
        <a>(博士の自動生成効率↑)</a>
        <div id="smj"></div>
        </div>
    <div id="sec" style="margin-top:40px;"></div>
    </div>
    <div style="width:300px;">
        <p>テスト用div</p>
        <p>ここで何か買えるようにしたい</p>
        <p>めんどい</p>
    <div>
        <button id="buy4">ガチャ(10000枚)</button>
        <a>(闇)</a>
        <div id="gacha"></div>
        </div>
    </div>
    </div>
    <script>
        document.onkeypress = enterForbidden;
        function enterForbidden(){
        if(window.event.keyCode == 13){
            return false;
        }
        }
        var renjiNum=0;
        var hakaseNum=0;
        var smjNum=0;
        var renjiPrice=50;
        var hakasePrice=50;
        var smjPrice=50;
        var sec =0;
        const gachaImgs =[
            "number_1.png",
            "number_2.png",
            "number_3.png",
            "kaichu_dokei.png"
        ];
        const gachaHaving=[
            0,
            0,
            0,
            0,
        ];
        const cre= document.getElementById("cre");
        const DOMsec= document.getElementById("sec");
        const buy= document.getElementById("buy");
        const result = document.getElementById("result");
        const infoCkick =document.getElementById("infoClick");
        const infoAuto =document.getElementById("infoAuto");
        var sum =200000;
        const number = document.getElementById("creNum");
        cre.x=1;
        number.textContent=cre.x;
        cre.addEventListener("click",function(event){
            if (event.keyCode === 13) {
                return false;
            }
            sum += cre.x;
            result.textContent=`×${sum}枚`;
        });
        buy.addEventListener("click",()=>{
        if(sum>=renjiPrice){
            renjiNum +=1;
            sum -=renjiPrice;
            cre.x +=3;
            renjiPrice =50*(renjiNum+1)*(renjiNum+1);

            buy.textContent=`クッキー焼き機を購入(${renjiPrice}枚)`
        number.textContent=cre.x;
            result.textContent=`×${sum}枚`;
        let renji_img=document.createElement("img");
        const renji=document.getElementById("renji");
        renji_img.src="images/oven_renji.png";
        renji_img.style="width:50px";
        renji_img.style="height:50px";
        renji.append(renji_img);
        infoCkick.textContent=`(${cre.x}枚/クリック)　`
        }
        });
        buy2.addEventListener("click",()=>{
        if(sum>=hakasePrice){
            hakaseNum +=1;
            sum -=hakasePrice;
            hakasePrice =50*(hakaseNum+1)*(hakaseNum+1);

            buy2.textContent=`博士を購入(${hakasePrice}枚)`
        number.textContent=cre.x;
            result.textContent=`×${sum}枚`;
        let hakase_img=document.createElement("img");
        const hakase=document.getElementById("hakase");
        hakase_img.src="images/hakase1_smile.png";
        hakase_img.style="width:50px";
        hakase_img.style="height:50px";
        hakase.append(hakase_img);
        infoAuto.textContent=`(${hakaseNum*3*(smjNum+1)}枚/秒)`
        }
        });
        buy3.addEventListener("click",()=>{
        if(sum>=smjPrice){
            smjNum +=1;
            sum -=smjPrice;
            smjPrice =10000*(smjNum+1)*(smjNum+1);

            buy3.textContent=`女王様を購入(${smjPrice}枚)`
        number.textContent=cre.x;
            result.textContent=`×${sum}枚`;
        let smj_img=document.createElement("img");
        const smj=document.getElementById("smj");
        smj_img.src="images/smj.png";
        smj_img.style="width:50px";
        smj_img.style="height:50px";
        smj.append(smj_img);
        infoAuto.textContent=`(${hakaseNum*3*(smjNum+1)}枚/秒)`
        }
        });
        buy4.addEventListener("click",()=>{
            if(sum>=10000){
                sum -=10000;
                let idx=Math.floor(Math.random() *(gachaHaving.length))
                gachaHaving[idx]+=1;
        hakaseInterval = 1000*(Math.pow(0.9,gachaHaving[3]))
        let gacha_img=document.createElement("img");
        const gacha=document.getElementById("gacha");
        gacha_img.src=`images/${gachaImgs[idx]}`;
        gacha_img.style="width:50px";
        gacha_img.style="height:50px";
        gacha.append(gacha_img);
            }
        });
        const countSec=()=>{
            sec++;
            DOMsec.textContent=`${sec}秒`
        };
        setInterval(countSec,1000);

        const hakaseWork=()=>{
            console.log(gachaHaving[3]);
            console.log(hakaseInterval)
            sum +=hakaseNum*3*(smjNum+1);
            result.textContent=`×${sum}枚`;
        }
        let hakaseInterval=1000;
        setInterval(hakaseWork,hakaseInterval);


    </script>
    
</body>
</html>